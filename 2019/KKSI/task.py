from Crypto.Util.number import *
import gmpy2

flag = 'KKSI2019{Ini_Bukan_Flag_Jadi_Tolong_Jangan_Disubmit_Plis_Ya_Kalau_Masih_Di_Submit_Tak_Ban_Teammu_Ya_Serius_Aku_Ini_Gak_Bercanda}'

p1 = getPrime(512)
p3 = gmpy2.next_prime(p1)
q1 = getPrime(512)
q3 = gmpy2.next_prime(q1)
p2 = getPrime(512)
p4 = gmpy2.next_prime(p2)
q2 = getPrime(512)
q4 = gmpy2.next_prime(q2)

e = 65537
n1 = p1*p3*q1*q3
n2 = p2*p4*q2*q4
phi1 = (p1-1)*(p3-1)*(q1-1)*(q3-1)
phi2 = (p2-1)*(p4-1)*(q2-1)*(q4-1)
d1 = gmpy2.invert(e,phi1)
d1 = gmpy2.invert(e,phi2)
c1 = pow(bytes_to_long(flag[0:16]),e,n1)
c1 = pow(c1,e,n1)
c1 = pow(c1,e,n1)
c2 = pow(bytes_to_long(flag[16:32]),e,n2)
c2 = pow(c2,e,n2)
c2 = pow(c2,e,n2)

print pow(p1+q3,65537,n1)
# 2716470887383700912025302124756638877079514015459719265795972589344992566952455298597389606104821087895516983639420976252616680796606735372353379773499974308475410079911643970916661913374023148541727244866521056996496836879151456345910942816878941002026121935028767147314106303135071477080803144640610324149525572799763398059797882036348456442719407594232037001832662661583800211109616457848055424917080717598667924120905358829556831258720187651752395859049219360376890171257052335463626723541800407685461449333405826339730428854302794392325983730172809464733029295792379446017853648202601484258544592666749076731063

print pow(p3+q1,65537,n1)
# 454675022048600002230757063981858747241092867712699117375776383004405026815887205699337788423912391230101141814715352667001091798390630717786561980856556437340681661923198015631082366039926409030402161695704470494725784595703992842882871363549601046313977960186674413849847074233789255413715830966722277989010362883389175158655923958612331679897795903578288902702644850409013952459848354916952677604031678874246334917840105723354762287985424845205296627648072511021334828633397007963458590483452960091956700261220490368041679041475696787618214694906949410993610740231064876951101303455802791862697489809375467558444

print pow(p2+q4,65537,n2)
# 25432937636478257787852114712991596087550392774955838547421402774411846309399609833028759032569391368662752237046585805390746955665315755541002082447847921217402372631279398195145957318868353124919819816208501929431245110034035878656466054069627696377346615018206180812258924032020321284922767344924342405215896654374044097610739848533610827186937689165572154136448003086248568674237425263282887257540090143303309991502353518077963761507324428976993183246632776897452739751649552188205514735431483861621647548504607228559429890669182213894945045011270065917975409199806436103731339383538216964368850312266112855016207

print pow(p4+q2,65537,n2)
# 22886233041203498785723632479325407085563721172628532756333622511477353618651022923647618944298175652535706184461842063199261723492424764968255110417844917219127037588566467943476866238424093194279835552521462333378588185844300096537565253888069969987629382966056595627270035397498493480694974379186482072889997216398686370676186481506638961657563491606859224491744221697973043771429416119501200381961667498345114431993841787571405754303617603157280060076793314809394169458616702155098867399067070665853040174536270957851445833926092617177557770085434018435170297201561033968959024878032259787243392691713054356192197

print n1 
# 11192469765780440204354233455893473450533469383686665706422403112172097246450777072828343247766272805210120052388873019126888121624414884048321141662657816148988467149089129782689977244100965006565974742398894926513457381565214235961647579456211358817083612529285968641527654660820358939303277892793176958617368112980843966922616621609880081326026092237626099342722014979476660862031715199461192910967192090443200975692142670841179692492037321269374979159833840953956304512988575163835782673510563969472119205213827392297434855623657731022931266885327072597755289375600880318990472522152581939268870701104919633244539

print n2
# 28573652978019841861061786203670665264025513759087100068358817929247495316642747761476775862618112289934754065650917442936482736085132024825507394391677881451366841967814626818341088343437407234932382374203541121792617138012549793730198041467793219211901334036761643738891590703635821408495786976676885624229347078886924799394938612243713974412216914952581192475496377379766454473746215090107339210222891843547105937023705680581996693347774350977629235280802603235119553888105396853028380849556140958735793133261644485764687619705363493191386618180673889236350482420056659633956284985294396946405528199089314344606103

print c1
# 5461530437054219344844349526730287404441695304882655098424741258137952059718382030687520057460517100741455411505362684965517589738745892799254390331926030691673389274333832481127775033629528462885005671370508652498338831645045197169495350203954608771055704474868835251629081524353356888413269805063802791742681874528539613636473360663228144274685487218584165641313251434301625345482340181762888294612344860211142610361125225392945230654151976168718893304635139982601212779931378559506753945421163856924113274506185508238737611444709774510133289411173671917115085338150689463009516850945695570455192612871296059254518

print c2
# 8879087744046910771488308902729286475689022048409584490745757290495011624614149802012984373145345920794412141611188037576423366982037288214171476839579531706215858425784220505376410055708328005168191520342722977293943145399260541081202111154185766431348861741029353594232371006637185080715776864052351301043677575406125475293473512470691526955549467974928790030857405680197032916313849708479913228654260184167962788876270165195677427492927763800743768115156692952366736598270150443418630164431223543746504909674687881584796206916999821348824874155403752575221826086980552093952400953944892556541578092265497754443170



##Task its start from line 30 - 51
